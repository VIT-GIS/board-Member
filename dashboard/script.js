const _0x3888c5=_0xd9c8;(function(_0x2c7457,_0x193b3c){const _0x2380be=_0xd9c8,_0x3b1638=_0x2c7457();while(!![]){try{const _0x3b371b=parseInt(_0x2380be(0x213))/0x1*(-parseInt(_0x2380be(0x1e0))/0x2)+parseInt(_0x2380be(0x228))/0x3+parseInt(_0x2380be(0x229))/0x4+-parseInt(_0x2380be(0x223))/0x5+-parseInt(_0x2380be(0x214))/0x6*(-parseInt(_0x2380be(0x221))/0x7)+-parseInt(_0x2380be(0x1eb))/0x8*(-parseInt(_0x2380be(0x22e))/0x9)+-parseInt(_0x2380be(0x201))/0xa*(parseInt(_0x2380be(0x20d))/0xb);if(_0x3b371b===_0x193b3c)break;else _0x3b1638['push'](_0x3b1638['shift']());}catch(_0x4d8490){_0x3b1638['push'](_0x3b1638['shift']());}}}(_0x3822,0x3345b));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js';function _0xd9c8(_0x329842,_0x28a505){const _0x382200=_0x3822();return _0xd9c8=function(_0xd9c89b,_0x311867){_0xd9c89b=_0xd9c89b-0x1dc;let _0x554c5e=_0x382200[_0xd9c89b];return _0x554c5e;},_0xd9c8(_0x329842,_0x28a505);}function _0x3822(){const _0x4e2286=['timestamp','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Phone\x22>','href','getElementById','992607CylAxv','669348lDECOh','querySelector','Enrollment_Data.xlsx','regNumber','data','182511AlQSRU','toLocaleString','includes','raybanpranav.mahesh2023@vitstudent.ac.in','name','1574ciwodc','vitgis-ba14f','replace','.delete-btn','tableBody','catch','1:759209581914:web:3432c0511eba57eca66763','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Preference\x201\x22>','editRegNumber','editPreference2','input','40sNOOXP','utils','addEventListener','editName','club_enrollement','createElement','textContent','preference2','https://board.geospatialvit.site/','searchInput','location','display','toLowerCase','preference1','querySelectorAll','target','editPreference1','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Preference\x202\x22>','forEach','none','then','Enrollment\x20Data','110CbteVv','style','editEmail','toDate','phone','\x22>Delete</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20','click','value','Error\x20signing\x20out:\x20','downloadExcel','innerHTML','editModal','125026zLzAvw','writeFile','book_append_sheet','exists','logoutBtn','editForm','281aSNihq','439620MmipFE','dataset','book_new','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Name\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Email\x22>','Error\x20updating\x20document:\x20','td:nth-child(2)','email','json_to_sheet','error','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Registration\x20No.\x22>','vitgis-ba14f.appspot.com','preventDefault','14vVZivN','editPhone','949785SvaqhS'];_0x3822=function(){return _0x4e2286;};return _0x3822();}import{getFirestore,collection,query,orderBy,onSnapshot,doc,getDoc,updateDoc,deleteDoc,getDocs}from'https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js';import{getAuth,onAuthStateChanged,signOut}from'https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js';import*as _0x163dfe from'https://cdn.sheetjs.com/xlsx-0.19.3/package/xlsx.mjs';const firebaseConfig={'apiKey':'AIzaSyCvg1AhjEd9vIiYWgqQlI5BO0jU3AF84t8','authDomain':'vitgis-ba14f.firebaseapp.com','projectId':_0x3888c5(0x1e1),'storageBucket':_0x3888c5(0x21f),'messagingSenderId':'759209581914','appId':_0x3888c5(0x1e6)},app=initializeApp(firebaseConfig),db=getFirestore(app),auth=getAuth(app),enrollmentCollection=collection(db,_0x3888c5(0x1ef)),allowedEmails=['sahildinesh.zambre2023@vitstudent.ac.in','ajitesh.sharma2023@vitstudent.ac.in',_0x3888c5(0x1de),'rohit.lalbahadur2023@vitstudent.ac.in'];onAuthStateChanged(auth,_0x4c7d18=>{const _0x540fca=_0x3888c5;_0x4c7d18?allowedEmails[_0x540fca(0x1dd)](_0x4c7d18[_0x540fca(0x21b)])?fetchData():window[_0x540fca(0x1f5)][_0x540fca(0x226)]=_0x540fca(0x1f3):window[_0x540fca(0x1f5)][_0x540fca(0x226)]=_0x540fca(0x1f3);});function fetchData(){const _0xa86ced=query(enrollmentCollection,orderBy('name'));onSnapshot(_0xa86ced,_0x1ae000=>{const _0x474670=_0xd9c8,_0x591046=document[_0x474670(0x227)](_0x474670(0x1e4));_0x591046['innerHTML']='',_0x1ae000[_0x474670(0x1fd)](_0x5c2a6a=>{const _0x5ea368=_0x474670,_0x20be13=_0x5c2a6a['data'](),_0x17482c=document[_0x5ea368(0x1f0)]('tr');_0x17482c[_0x5ea368(0x20b)]=_0x5ea368(0x217)+_0x20be13[_0x5ea368(0x1df)]+_0x5ea368(0x21e)+_0x20be13[_0x5ea368(0x22c)]+_0x5ea368(0x218)+_0x20be13[_0x5ea368(0x21b)]+_0x5ea368(0x225)+_0x20be13[_0x5ea368(0x205)]+_0x5ea368(0x1e7)+_0x20be13[_0x5ea368(0x1f8)]+_0x5ea368(0x1fc)+_0x20be13[_0x5ea368(0x1f2)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Submitted\x20At\x22>'+_0x20be13['timestamp'][_0x5ea368(0x204)]()[_0x5ea368(0x1dc)]()+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-btn\x22\x20data-id=\x22'+_0x5c2a6a['id']+'\x22>Edit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-btn\x22\x20data-id=\x22'+_0x5c2a6a['id']+_0x5ea368(0x206),_0x591046['appendChild'](_0x17482c);}),document['querySelectorAll']('.edit-btn')['forEach'](_0x363752=>{const _0x4a36f3=_0x474670;_0x363752[_0x4a36f3(0x1ed)](_0x4a36f3(0x207),_0x21e26b=>{const _0x50ca6c=_0x4a36f3,_0x386060=_0x21e26b['target'][_0x50ca6c(0x215)]['id'];openEditModal(_0x386060);});}),document[_0x474670(0x1f9)](_0x474670(0x1e3))[_0x474670(0x1fd)](_0x1f5157=>{const _0x5a2210=_0x474670;_0x1f5157[_0x5a2210(0x1ed)](_0x5a2210(0x207),_0x8dfbbb=>{const _0xbbdc38=_0x5a2210,_0x8d40=_0x8dfbbb[_0xbbdc38(0x1fa)][_0xbbdc38(0x215)]['id'];deleteRecord(_0x8d40);});});});}let editingDocId=null;function openEditModal(_0x504f89){const _0x19bcfc=_0x3888c5;editingDocId=_0x504f89;const _0x1c415f=doc(db,_0x19bcfc(0x1ef),_0x504f89);getDoc(_0x1c415f)[_0x19bcfc(0x1ff)](_0x43cdb6=>{const _0x4eb3e3=_0x19bcfc;if(_0x43cdb6[_0x4eb3e3(0x210)]()){const _0x3a7d89=_0x43cdb6[_0x4eb3e3(0x22d)]();document['getElementById'](_0x4eb3e3(0x1ee))[_0x4eb3e3(0x208)]=_0x3a7d89[_0x4eb3e3(0x1df)],document[_0x4eb3e3(0x227)](_0x4eb3e3(0x1e8))[_0x4eb3e3(0x208)]=_0x3a7d89[_0x4eb3e3(0x22c)],document[_0x4eb3e3(0x227)]('editEmail')['value']=_0x3a7d89[_0x4eb3e3(0x21b)],document['getElementById'](_0x4eb3e3(0x222))[_0x4eb3e3(0x208)]=_0x3a7d89['phone'],document[_0x4eb3e3(0x227)](_0x4eb3e3(0x1fb))[_0x4eb3e3(0x208)]=_0x3a7d89[_0x4eb3e3(0x1f8)],document['getElementById'](_0x4eb3e3(0x1e9))[_0x4eb3e3(0x208)]=_0x3a7d89[_0x4eb3e3(0x1f2)],document[_0x4eb3e3(0x227)](_0x4eb3e3(0x20c))[_0x4eb3e3(0x202)]['display']='block';}});}document[_0x3888c5(0x227)](_0x3888c5(0x212))[_0x3888c5(0x1ed)]('submit',_0x9b6ee5=>{const _0x3c14fb=_0x3888c5;_0x9b6ee5[_0x3c14fb(0x220)]();const _0x1dc699={'name':document[_0x3c14fb(0x227)](_0x3c14fb(0x1ee))[_0x3c14fb(0x208)],'regNumber':document[_0x3c14fb(0x227)](_0x3c14fb(0x1e8))['value'],'email':document[_0x3c14fb(0x227)](_0x3c14fb(0x203))[_0x3c14fb(0x208)],'phone':document[_0x3c14fb(0x227)]('editPhone')['value'],'preference1':document[_0x3c14fb(0x227)](_0x3c14fb(0x1fb))[_0x3c14fb(0x208)],'preference2':document['getElementById'](_0x3c14fb(0x1e9))[_0x3c14fb(0x208)]},_0x4d6568=doc(db,_0x3c14fb(0x1ef),editingDocId);updateDoc(_0x4d6568,_0x1dc699)['then'](()=>{closeEditModal(),alert('Data\x20updated\x20successfully');})[_0x3c14fb(0x1e5)](_0x398b4a=>{const _0x41a05e=_0x3c14fb;console['error'](_0x41a05e(0x219),_0x398b4a);});}),document[_0x3888c5(0x22a)]('.close-btn')['addEventListener'](_0x3888c5(0x207),closeEditModal);function closeEditModal(){const _0x5973b4=_0x3888c5;document[_0x5973b4(0x227)](_0x5973b4(0x20c))[_0x5973b4(0x202)][_0x5973b4(0x1f6)]=_0x5973b4(0x1fe);}function deleteRecord(_0x27d158){const _0x340e3b=_0x3888c5,_0x111035=doc(db,_0x340e3b(0x1ef),_0x27d158);deleteDoc(_0x111035)['then'](()=>{alert('Record\x20deleted\x20successfully');})[_0x340e3b(0x1e5)](_0x31bd42=>{console['error']('Error\x20deleting\x20document:\x20',_0x31bd42);});}document[_0x3888c5(0x227)](_0x3888c5(0x1f4))[_0x3888c5(0x1ed)](_0x3888c5(0x1ea),_0x195d65=>{const _0x45c78c=_0x3888c5,_0x3106b5=_0x195d65[_0x45c78c(0x1fa)]['value'][_0x45c78c(0x1f7)](),_0x45be7e=document[_0x45c78c(0x1f9)]('#tableBody\x20tr');_0x45be7e['forEach'](_0x57a04c=>{const _0xeffe96=_0x45c78c,_0x1ce9cc=_0x57a04c[_0xeffe96(0x22a)](_0xeffe96(0x21a))[_0xeffe96(0x1f1)]['toLowerCase']();_0x57a04c[_0xeffe96(0x202)][_0xeffe96(0x1f6)]=_0x1ce9cc['includes'](_0x3106b5)?'':'none';});}),document[_0x3888c5(0x227)](_0x3888c5(0x20a))[_0x3888c5(0x1ed)]('click',async()=>{const _0x240aec=_0x3888c5,_0x246b70=query(enrollmentCollection,orderBy('name')),_0x11c3a7=await getDocs(_0x246b70),_0x522bff=[];_0x11c3a7[_0x240aec(0x1fd)](_0x40867c=>{const _0x7ea748=_0x240aec,_0x1fa252=_0x40867c[_0x7ea748(0x22d)]();_0x522bff['push']({'Name':_0x1fa252[_0x7ea748(0x1df)],'Registration\x20Number':_0x1fa252[_0x7ea748(0x22c)],'Email':_0x1fa252[_0x7ea748(0x21b)],'Phone':_0x1fa252['phone'],'Preference\x201':_0x1fa252['preference1'],'Preference\x202':_0x1fa252[_0x7ea748(0x1f2)],'Submitted\x20At':_0x1fa252[_0x7ea748(0x224)][_0x7ea748(0x204)]()[_0x7ea748(0x1dc)]()});});const _0x1286d5=_0x163dfe[_0x240aec(0x1ec)][_0x240aec(0x21c)](_0x522bff),_0x3fec08=_0x163dfe['utils'][_0x240aec(0x216)]();_0x163dfe[_0x240aec(0x1ec)][_0x240aec(0x20f)](_0x3fec08,_0x1286d5,_0x240aec(0x200)),_0x163dfe[_0x240aec(0x20e)](_0x3fec08,_0x240aec(0x22b));});function logout(){const _0x52fe0d=_0x3888c5;signOut(auth)[_0x52fe0d(0x1ff)](()=>{const _0x974867=_0x52fe0d;window['location'][_0x974867(0x1e2)](_0x974867(0x1f3));})['catch'](_0x5d309b=>{const _0x427880=_0x52fe0d;console[_0x427880(0x21d)](_0x427880(0x209),_0x5d309b);});}document[_0x3888c5(0x227)](_0x3888c5(0x211))[_0x3888c5(0x1ed)](_0x3888c5(0x207),logout);
