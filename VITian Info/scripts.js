const _0x3ea03b=_0x3b43;(function(_0x3ac0fa,_0x4020fe){const _0x19ad40=_0x3b43,_0x2637d9=_0x3ac0fa();while(!![]){try{const _0x2fab3e=-parseInt(_0x19ad40(0x12b))/0x1+-parseInt(_0x19ad40(0x129))/0x2*(-parseInt(_0x19ad40(0x10f))/0x3)+parseInt(_0x19ad40(0x13c))/0x4*(-parseInt(_0x19ad40(0x13a))/0x5)+-parseInt(_0x19ad40(0x121))/0x6+-parseInt(_0x19ad40(0x103))/0x7*(parseInt(_0x19ad40(0x11e))/0x8)+-parseInt(_0x19ad40(0x138))/0x9+-parseInt(_0x19ad40(0x123))/0xa*(-parseInt(_0x19ad40(0x13b))/0xb);if(_0x2fab3e===_0x4020fe)break;else _0x2637d9['push'](_0x2637d9['shift']());}catch(_0x850fb9){_0x2637d9['push'](_0x2637d9['shift']());}}}(_0x2951,0x4c155));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';import{getAuth,onAuthStateChanged,signOut}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js';import{getFirestore,collection,onSnapshot}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js';function _0x3b43(_0x22e87a,_0x145cfe){const _0x29514a=_0x2951();return _0x3b43=function(_0x3b439b,_0x235bc3){_0x3b439b=_0x3b439b-0xfe;let _0x4da92a=_0x29514a[_0x3b439b];return _0x4da92a;},_0x3b43(_0x22e87a,_0x145cfe);}function _0x2951(){const _0x3eb9ea=['DOMContentLoaded','387336lsONHr','input','utils','</td>\x0a\x20\x20\x20\x20','N/A','short','toDate','innerHTML','toLocaleString','en-US','You\x20have\x20been\x20logged\x20out.','email','map','phone','addEventListener','77416mAdRwi','sahildinesh.zambre2023@vitstudent.ac.in','click','1157916dKuigf','catch','374740OcCrcB','regNumber','timestamp','Error\x20fetching\x20real-time\x20data:\x20','createElement','#data-table\x20tbody','2CzJCXx','forEach','158492NsvZfu','toLowerCase','\x0a\x20\x20\x20\x20\x20\x20<td>','numeric','2-digit','href','vitgis-ba14f.firebaseapp.com','search-input','1:759209581914:web:3432c0511eba57eca66763','writeFile','Unauthorized\x20access!\x20Redirecting\x20to\x20login...','name','rohit.lalbahadur2023@vitstudent.ac.in','1585989bObSdi','Logout\x20failed:','73115gNmqKK','407lJFPtk','140nuXWCQ','filter','then','vitgis-ba14f','ajitesh.sharma2023@vitstudent.ac.in','getElementById','error','119JWlFNd','includes','querySelector','VITians\x20Data','location','value','message','</td>\x0a\x20\x20\x20\x20\x20\x20<td>','https://board.geospatialvit.site/','download-btn','raybanpranav.mahesh2023@vitstudent.ac.in'];_0x2951=function(){return _0x3eb9ea;};return _0x2951();}import*as _0xa6f76c from'https://cdn.sheetjs.com/xlsx-0.19.3/package/xlsx.mjs';const firebaseConfig={'apiKey':'AIzaSyCvg1AhjEd9vIiYWgqQlI5BO0jU3AF84t8','authDomain':_0x3ea03b(0x131),'projectId':_0x3ea03b(0xff),'storageBucket':'vitgis-ba14f.appspot.com','messagingSenderId':'759209581914','appId':_0x3ea03b(0x133)},app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),allowedEmails=[_0x3ea03b(0x11f),_0x3ea03b(0x100),_0x3ea03b(0x10d),_0x3ea03b(0x137)];function checkAuthorization(){onAuthStateChanged(auth,_0x37eaf0=>{const _0xea4027=_0x3b43;if(_0x37eaf0){const _0x41be23=_0x37eaf0[_0xea4027(0x11a)];!allowedEmails[_0xea4027(0x104)](_0x41be23)?(alert(_0xea4027(0x135)),window['location'][_0xea4027(0x130)]='https://board.geospatialvit.site/'):fetchAndDisplayData();}else alert('Please\x20log\x20in\x20to\x20access\x20this\x20page.'),window['location'][_0xea4027(0x130)]=_0xea4027(0x10b);});}function fetchAndDisplayData(){const _0x56c52e=_0x3ea03b,_0x50aa06=document[_0x56c52e(0x105)](_0x56c52e(0x128)),_0x2e0e59=document[_0x56c52e(0x101)](_0x56c52e(0x132));onSnapshot(collection(db,'VITians'),_0xc9606c=>{const _0x2ca68e=_0x56c52e,_0x5c69e8=[];_0xc9606c[_0x2ca68e(0x12a)](_0x5bd912=>_0x5c69e8['push'](_0x5bd912['data']())),renderTable(_0x5c69e8),_0x2e0e59[_0x2ca68e(0x11d)](_0x2ca68e(0x110),()=>{const _0x4f2276=_0x2ca68e,_0xa42e7f=_0x2e0e59[_0x4f2276(0x108)]['toLowerCase'](),_0x5c47b3=_0x5c69e8[_0x4f2276(0x13d)](_0x5139b6=>_0x5139b6['regNumber'][_0x4f2276(0x12c)]()[_0x4f2276(0x104)](_0xa42e7f));renderTable(_0x5c47b3);}),document[_0x2ca68e(0x101)](_0x2ca68e(0x10c))[_0x2ca68e(0x11d)]('click',()=>downloadExcel(_0x5c69e8));},_0x29d90c=>{const _0xd3ab9a=_0x56c52e;console[_0xd3ab9a(0x102)](_0xd3ab9a(0x126),_0x29d90c);});}function renderTable(_0x24ff88){const _0x5bef98=_0x3ea03b,_0x4c6004=document[_0x5bef98(0x105)]('#data-table\x20tbody');_0x4c6004[_0x5bef98(0x116)]='',_0x24ff88['forEach'](_0x2d44e6=>{const _0x1b398b=_0x5bef98,_0x189dda=_0x2d44e6[_0x1b398b(0x125)]?formatTimestamp(_0x2d44e6[_0x1b398b(0x125)]):_0x1b398b(0x113),_0x142d67=document[_0x1b398b(0x127)]('tr');_0x142d67[_0x1b398b(0x116)]=_0x1b398b(0x12d)+(_0x2d44e6[_0x1b398b(0x124)]||_0x1b398b(0x113))+'</td>\x0a\x20\x20\x20\x20\x20\x20<td>'+(_0x2d44e6[_0x1b398b(0x136)]||_0x1b398b(0x113))+_0x1b398b(0x10a)+(_0x2d44e6[_0x1b398b(0x11a)]||'N/A')+_0x1b398b(0x10a)+(_0x2d44e6[_0x1b398b(0x11c)]||_0x1b398b(0x113))+_0x1b398b(0x10a)+_0x189dda+_0x1b398b(0x112),_0x4c6004['appendChild'](_0x142d67);});}function formatTimestamp(_0x249223){const _0x17c4fe=_0x3ea03b,_0x86c2cb=_0x249223[_0x17c4fe(0x115)]?_0x249223[_0x17c4fe(0x115)]():new Date(_0x249223),_0x5d31e7={'year':_0x17c4fe(0x12e),'month':_0x17c4fe(0x114),'day':_0x17c4fe(0x12e),'hour':_0x17c4fe(0x12f),'minute':_0x17c4fe(0x12f),'second':_0x17c4fe(0x12f)};return _0x86c2cb[_0x17c4fe(0x117)](_0x17c4fe(0x118),_0x5d31e7);}function downloadExcel(_0x5e2337){const _0x1988ca=_0x3ea03b,_0x489276=_0x5e2337[_0x1988ca(0x11b)](_0xc2a357=>({'Reg.\x20Number':_0xc2a357[_0x1988ca(0x124)]||'N/A','Name':_0xc2a357['name']||_0x1988ca(0x113),'Email':_0xc2a357[_0x1988ca(0x11a)]||_0x1988ca(0x113),'Phone':_0xc2a357[_0x1988ca(0x11c)]||_0x1988ca(0x113),'Reg.\x20Date\x20&\x20Time':_0xc2a357['timestamp']?formatTimestamp(_0xc2a357[_0x1988ca(0x125)]):_0x1988ca(0x113)})),_0x3a8798=_0xa6f76c[_0x1988ca(0x111)]['json_to_sheet'](_0x489276),_0x347488=_0xa6f76c[_0x1988ca(0x111)]['book_new']();_0xa6f76c[_0x1988ca(0x111)]['book_append_sheet'](_0x347488,_0x3a8798,_0x1988ca(0x106)),_0xa6f76c[_0x1988ca(0x134)](_0x347488,'VITians_Data.xlsx');}function handleLogout(){const _0x4b357a=_0x3ea03b;signOut(auth)[_0x4b357a(0xfe)](()=>{const _0x5cb4be=_0x4b357a;alert(_0x5cb4be(0x119)),window[_0x5cb4be(0x107)][_0x5cb4be(0x130)]=_0x5cb4be(0x10b);})[_0x4b357a(0x122)](_0x12c19f=>{const _0x3dd1c3=_0x4b357a;console['error'](_0x3dd1c3(0x139),_0x12c19f[_0x3dd1c3(0x109)]);});}document[_0x3ea03b(0x101)]('logout-btn')?.['addEventListener'](_0x3ea03b(0x120),handleLogout),document[_0x3ea03b(0x11d)](_0x3ea03b(0x10e),checkAuthorization);
